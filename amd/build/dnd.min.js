define("qtype_matrix/dnd",["exports","jquery"],(function(_exports,_jquery){var obj;
/**
   * @copyright  2015  Universit√© de Lausanne
   * @author Nicolas Dunand <nicolas.dunand@unil.ch>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};_exports.init=function(){var n=0,dnduistr="qtype_matrix_dndui",$=_jquery.default,wasDropped=function(ismultiple,$tr,$cell,text,$draggable,checkBoxes){ismultiple||(checkBoxes&&($tr.find("input").prop("checked",!1),$cell.parents("tr").find('.cell:has("input") span').remove()),$draggable.draggable("disable"),$draggable.addClass("disabled")),checkBoxes&&$cell.find("input").prop("checked",!0);var $newspan=$("<span>").text(text),$deletebutton=$("<span>").text("X");$deletebutton.click((function(){var $btn=$(this);$btn.parents("td").find("input").prop("checked",!1),$draggable.draggable("enable"),$draggable.removeClass("disabled"),$btn.parent().remove()})),$deletebutton.appendTo($newspan),$newspan.appendTo($cell)};$(".que.matrix").each((function(){n++;var $question=$(this),$matrix=$question.find("table.matrix");if($matrix.hasClass("uses_dndui")){var $baskets=$question.find("th:has('span.title')"),$receptacles=$matrix.find('.cell:has("input")'),$items=$question.find(".cell.c0"),ismultiple=!!$matrix.find("input[type=checkbox]").length;$question.addClass("clearfix").addClass(dnduistr),$baskets.addClass("outerwalled"),$receptacles.addClass("outerwalled");var it=0;$items.each((function(){it++;var text=$(this).find("span.title").text(),$tr=$matrix.find("tbody tr").eq(it-1),$draggable=$(this).find("span.title");$draggable.attr("class",dnduistr+"_item "+dnduistr+"_"+n+"_item_"+it),$draggable.draggable({helper:"clone",revert:"invalid",opacity:.5,containment:$matrix,scope:dnduistr+"_"+n+"_item_"+it}),$tr.find('.cell:has("input")').each((function(){var $cell=$(this);$cell.droppable({activeClass:"activated",hoverClass:"hovered",tolerance:"pointer",scope:dnduistr+"_"+n+"_item_"+it,drop:function(){wasDropped(ismultiple,$tr,$cell,text,$draggable,!0)}}),$cell.find("input").prop("checked")&&wasDropped(ismultiple,$tr,$cell,text,$draggable,!1)}))})),$receptacles.eq(0).find("input").prop("disabled")&&($items.find("span.title").draggable("disable").addClass("disabled"),$receptacles.find("span span").remove())}}))}}));

//# sourceMappingURL=dnd.min.js.map